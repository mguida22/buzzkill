!function(t){t.fn.famultibutton=function(o){function n(){f=!0,c.children().first().css("color",O.onBackgroundColor),c.children().last().css("color",O.onColor)}function e(){f=!1,c.children().first().css("color",O.offBackgroundColor),c.children().last().css("color",O.offColor)}function l(){f&&(f=!1,t("<div />").animate({width:100},{duration:700,easing:"swing",step:function(t,o){var n=(t-o.start)/(o.end-o.start);c.children().first().css("color",getGradientColor(O.onBackgroundColor,O.offBackgroundColor,n)),c.children().last().css("color",getGradientColor(O.onColor,O.offColor,n))}}))}function i(){clearTimeout(u),p=m>0?p-=1:p+=1,p>100&&(p=100),0>p&&(p=0),s();var t=d[Math.abs(m)];u=setTimeout(function(){i()},500-t)}function s(){var t=r[0];if(t.height=c.innerHeight(),t.width=c.innerWidth(),t.getContext){var o=t.getContext("2d");o.strokeStyle=O.offBackgroundColor;for(var n=t.height-Math.round(t.height*p/100),e=0;e<t.height;e+=4)o.lineWidth=1,o.beginPath(),o.moveTo(5,e),o.lineTo(25,e),o.stroke();o.strokeStyle=f?O.onBackgroundColor:getGradientColor(O.offBackgroundColor,"#ffffff",.4),o.lineWidth=3,o.beginPath(),o.moveTo(5,n),o.lineTo(25,n),o.stroke(),o.fillStyle=getGradientColor(O.offBackgroundColor,"#ffffff",.4),o.font="10px sans-serif",o.fillText(p,30,t.height)}}function a(){r.css({position:"absolute","z-index":-1}),r.animate(b?{left:.6*-c.innerWidth()+"px"}:{left:c.innerWidth()/5+"px",top:v})}if(this.length>1)return this.each(function(){t(this).famultibutton(o)}),this;var r,u,c=this,f=!1,h=!1,d=[0,10,40,80,120,140,150,160,180,200,240,260,280,300,320,420,430,440,450,460,470],g=0,p=0,m=0,v=0,C=0,b=!1,k=!1,x={backgroundIcon:"fa-circle",classes:["fa-2x"],icon:"fa-power-off",offColor:"#2A2A2A",offBackgroundColor:"#505050",onColor:"#2A2A2A",onBackgroundColor:"#aa6900",mode:"toggle",toggleOn:null,toggleOff:null,valueChanged:null},O=t.extend({},x,o),y=function(){if(O=t.extend({},O,c.data()),c.addClass("fa-stack"),jQuery("<i/>",{id:"bg","class":"fa fa-stack-2x"}).addClass(O.backgroundIcon).appendTo(c),jQuery("<i/>",{id:"fg","class":"fa fa-stack-1x"}).addClass(O.icon).appendTo(c),O.classes&&O.classes.length>0)for(var o=0;o<O.classes.length;o++)c.addClass(O.classes[o]);return e(),"dimmer"==O.mode&&(t("<canvas>").attr({id:"scale"}).appendTo(c),r=c.find("canvas#scale"),r.css({height:c.innerHeight()+4}),v=parseInt(r.offset().top)-parseInt(c.offset().top),s(),a()),c.data("famultibutton",c),c};if(getGradientColor=function(t,o,n){t=t.replace(/^\s*#|\s*$/g,""),o=o.replace(/^\s*#|\s*$/g,""),3==t.length&&(t=t.replace(/(.)/g,"$1$1")),3==o.length&&(o=o.replace(/(.)/g,"$1$1"));var e=parseInt(t.substr(0,2),16),l=parseInt(t.substr(2,2),16),i=parseInt(t.substr(4,2),16),s=parseInt(o.substr(0,2),16),a=parseInt(o.substr(2,2),16),r=parseInt(o.substr(4,2),16),u=s-e,c=a-l,f=r-i;return u=(u*n+e).toString(16).split(".")[0],c=(c*n+l).toString(16).split(".")[0],f=(f*n+i).toString(16).split(".")[0],1==u.length&&(u="0"+u),1==c.length&&(c="0"+c),1==f.length&&(f="0"+f),"#"+u+c+f},"push"==O.mode){var I=null!==document.ontouchstart?"mousedown":"touchstart",T=null!==document.ontouchend?"mouseup":"touchend",B=null!==document.ontouchleave?"mouseout":"touchleave";this.bind(I,function(){n(),"function"==typeof O.toggleOn&&O.toggleOn.call(this)}),this.bind(T,function(){l()}),this.bind(B,function(){l()})}else if("toggle"==O.mode){var I=null!==document.ontouchstart?"click":"touchstart";this.bind(I,function(t){f?(e(),"function"==typeof O.toggleOff&&O.toggleOff.call(this)):(n(),"function"==typeof O.toggleOn&&O.toggleOn.call(this)),t.preventDefault()})}else if("dimmer"==O.mode){var I=null!==document.ontouchstart?"mousedown":"touchstart",S=null!==document.ontouchmove?"mousemove":"touchmove",T=null!==document.ontouchend?"mouseup":"touchend",B=null!==document.ontouchleave?"mouseout":"touchleave";this.bind(I,function(t){var o=t.originalEvent;g=o.touches?o.touches[0].clientY:t.pageY,m=0,k=!0,t.preventDefault()}),this.bind(B,function(t){b&&(b=!1,c.animate({top:0}),clearInterval(u),h=!1,a()),k=!1,t.preventDefault()}),this.bind(T,function(t){b?(b=!1,c.animate({top:0}),clearTimeout(u),h=!1,"function"==typeof O.valueChanged&&O.valueChanged.call(this,p)):f?(e(),"function"==typeof O.toggleOff&&O.toggleOff.call(this)):(n(),"function"==typeof O.toggleOn&&O.toggleOn.call(this)),b=!1,k=!1,a(),s(),t.preventDefault()}),this.bind(S,function(t){k&&(b=!0);var o=t.originalEvent;C=o.touches?o.touches[0].clientY:t.pageY,m=C-g,m>20&&(m=20),-20>m&&(m=-20),b&&(this.style.top=m+"px",h||(a(),i(),h=!0),r.css({top:-m+"px"})),t.preventDefault()})}return this.setOn=function(){n()},this.setOff=function(){e()},this.getState=function(){return f},this.getValue=function(){return p},this.setValue=function(t){p=t,s()},y()}}(jQuery);